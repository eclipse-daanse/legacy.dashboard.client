var Ae=Object.defineProperty;var Te=(n,e,t)=>e in n?Ae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var y=(n,e,t)=>(Te(n,typeof e!="symbol"?e+"":e,t),t);import{c as ee}from"./_commonjsHelpers-725317a4.js";var Z={exports:{}};(function(n,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof ee<"u"&&ee,s=function(){function o(){this.fetch=!1,this.DOMException=t.DOMException}return o.prototype=t,new o}();(function(o){(function(c){var l=typeof o<"u"&&o||typeof self<"u"&&self||typeof l<"u"&&l,u={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function m(a){return a&&DataView.prototype.isPrototypeOf(a)}if(u.arrayBuffer)var d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(a){return a&&d.indexOf(Object.prototype.toString.call(a))>-1};function R(a){if(typeof a!="string"&&(a=String(a)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(a)||a==="")throw new TypeError('Invalid character in header field name: "'+a+'"');return a.toLowerCase()}function A(a){return typeof a!="string"&&(a=String(a)),a}function S(a){var h={next:function(){var T=a.shift();return{done:T===void 0,value:T}}};return u.iterable&&(h[Symbol.iterator]=function(){return h}),h}function p(a){this.map={},a instanceof p?a.forEach(function(h,T){this.append(T,h)},this):Array.isArray(a)?a.forEach(function(h){this.append(h[0],h[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(h){this.append(h,a[h])},this)}p.prototype.append=function(a,h){a=R(a),h=A(h);var T=this.map[a];this.map[a]=T?T+", "+h:h},p.prototype.delete=function(a){delete this.map[R(a)]},p.prototype.get=function(a){return a=R(a),this.has(a)?this.map[a]:null},p.prototype.has=function(a){return this.map.hasOwnProperty(R(a))},p.prototype.set=function(a,h){this.map[R(a)]=A(h)},p.prototype.forEach=function(a,h){for(var T in this.map)this.map.hasOwnProperty(T)&&a.call(h,this.map[T],T,this)},p.prototype.keys=function(){var a=[];return this.forEach(function(h,T){a.push(T)}),S(a)},p.prototype.values=function(){var a=[];return this.forEach(function(h){a.push(h)}),S(a)},p.prototype.entries=function(){var a=[];return this.forEach(function(h,T){a.push([T,h])}),S(a)},u.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function D(a){if(a.bodyUsed)return Promise.reject(new TypeError("Already read"));a.bodyUsed=!0}function x(a){return new Promise(function(h,T){a.onload=function(){h(a.result)},a.onerror=function(){T(a.error)}})}function Y(a){var h=new FileReader,T=x(h);return h.readAsArrayBuffer(a),T}function H(a){var h=new FileReader,T=x(h);return h.readAsText(a),T}function L(a){for(var h=new Uint8Array(a),T=new Array(h.length),C=0;C<h.length;C++)T[C]=String.fromCharCode(h[C]);return T.join("")}function M(a){if(a.slice)return a.slice(0);var h=new Uint8Array(a.byteLength);return h.set(new Uint8Array(a)),h.buffer}function B(){return this.bodyUsed=!1,this._initBody=function(a){this.bodyUsed=this.bodyUsed,this._bodyInit=a,a?typeof a=="string"?this._bodyText=a:u.blob&&Blob.prototype.isPrototypeOf(a)?this._bodyBlob=a:u.formData&&FormData.prototype.isPrototypeOf(a)?this._bodyFormData=a:u.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)?this._bodyText=a.toString():u.arrayBuffer&&u.blob&&m(a)?(this._bodyArrayBuffer=M(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):u.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||_(a))?this._bodyArrayBuffer=M(a):this._bodyText=a=Object.prototype.toString.call(a):this._bodyText="",this.headers.get("content-type")||(typeof a=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):u.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u.blob&&(this.blob=function(){var a=D(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var a=D(this);return a||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(Y)}),this.text=function(){var a=D(this);if(a)return a;if(this._bodyBlob)return H(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},u.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}var j=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(a){var h=a.toUpperCase();return j.indexOf(h)>-1?h:a}function I(a,h){if(!(this instanceof I))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');h=h||{};var T=h.body;if(a instanceof I){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,h.headers||(this.headers=new p(a.headers)),this.method=a.method,this.mode=a.mode,this.signal=a.signal,!T&&a._bodyInit!=null&&(T=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);if(this.credentials=h.credentials||this.credentials||"same-origin",(h.headers||!this.headers)&&(this.headers=new p(h.headers)),this.method=k(h.method||this.method||"GET"),this.mode=h.mode||this.mode||null,this.signal=h.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&T)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(T),(this.method==="GET"||this.method==="HEAD")&&(h.cache==="no-store"||h.cache==="no-cache")){var C=/([?&])_=[^&]*/;if(C.test(this.url))this.url=this.url.replace(C,"$1_="+new Date().getTime());else{var b=/\?/;this.url+=(b.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function O(a){var h=new FormData;return a.trim().split("&").forEach(function(T){if(T){var C=T.split("="),b=C.shift().replace(/\+/g," "),g=C.join("=").replace(/\+/g," ");h.append(decodeURIComponent(b),decodeURIComponent(g))}}),h}function F(a){var h=new p,T=a.replace(/\r?\n[\t ]+/g," ");return T.split("\r").map(function(C){return C.indexOf(`
`)===0?C.substr(1,C.length):C}).forEach(function(C){var b=C.split(":"),g=b.shift().trim();if(g){var X=b.join(":").trim();h.append(g,X)}}),h}B.call(I.prototype);function q(a,h){if(!(this instanceof q))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');h||(h={}),this.type="default",this.status=h.status===void 0?200:h.status,this.ok=this.status>=200&&this.status<300,this.statusText=h.statusText===void 0?"":""+h.statusText,this.headers=new p(h.headers),this.url=h.url||"",this._initBody(a)}B.call(q.prototype),q.prototype.clone=function(){return new q(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},q.error=function(){var a=new q(null,{status:0,statusText:""});return a.type="error",a};var Ee=[301,302,303,307,308];q.redirect=function(a,h){if(Ee.indexOf(h)===-1)throw new RangeError("Invalid status code");return new q(null,{status:h,headers:{location:a}})},c.DOMException=l.DOMException;try{new c.DOMException}catch{c.DOMException=function(h,T){this.message=h,this.name=T;var C=Error(h);this.stack=C.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function K(a,h){return new Promise(function(T,C){var b=new I(a,h);if(b.signal&&b.signal.aborted)return C(new c.DOMException("Aborted","AbortError"));var g=new XMLHttpRequest;function X(){g.abort()}g.onload=function(){var v={status:g.status,statusText:g.statusText,headers:F(g.getAllResponseHeaders()||"")};v.url="responseURL"in g?g.responseURL:v.headers.get("X-Request-URL");var z="response"in g?g.response:g.responseText;setTimeout(function(){T(new q(z,v))},0)},g.onerror=function(){setTimeout(function(){C(new TypeError("Network request failed"))},0)},g.ontimeout=function(){setTimeout(function(){C(new TypeError("Network request failed"))},0)},g.onabort=function(){setTimeout(function(){C(new c.DOMException("Aborted","AbortError"))},0)};function ye(v){try{return v===""&&l.location.href?l.location.href:v}catch{return v}}g.open(b.method,ye(b.url),!0),b.credentials==="include"?g.withCredentials=!0:b.credentials==="omit"&&(g.withCredentials=!1),"responseType"in g&&(u.blob?g.responseType="blob":u.arrayBuffer&&b.headers.get("Content-Type")&&b.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(g.responseType="arraybuffer")),h&&typeof h.headers=="object"&&!(h.headers instanceof p)?Object.getOwnPropertyNames(h.headers).forEach(function(v){g.setRequestHeader(v,A(h.headers[v]))}):b.headers.forEach(function(v,z){g.setRequestHeader(z,v)}),b.signal&&(b.signal.addEventListener("abort",X),g.onreadystatechange=function(){g.readyState===4&&b.signal.removeEventListener("abort",X)}),g.send(typeof b._bodyInit>"u"?null:b._bodyInit)})}return K.polyfill=!0,l.fetch||(l.fetch=K,l.Headers=p,l.Request=I,l.Response=q),c.Headers=p,c.Request=I,c.Response=q,c.fetch=K,c})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var i=t.fetch?t:s;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,n.exports=e})(Z,Z.exports);var Re=Z.exports;async function ne(n,e,t={}){let s;try{s=fetch}catch{s=Re.fetch}return await s(n,{method:e?"POST":"GET",headers:{...{Accept:"text/html,application/xhtml+xml,application/xml","Content-Type":"text/xml"},...t},body:e})}function ge(n,e){for(const t in n)if(n[t]===e)return t}class xe{constructor(e,t){y(this,"wsdl");y(this,"endpoint");y(this,"security");this.wsdl=e,this.endpoint=t,this._initializeServices(t)}setEndpoint(e){this.endpoint=e,this._initializeServices(this.endpoint,!0)}describe(){return this.wsdl.describeServices()}setSecurity(e){this.security=e}setSOAPAction(e){this.SOAPAction=e}_initializeServices(e,t=!1){const i=this.wsdl.definitions.services;for(const o in i)this[o]=this._defineService(i[o],e,t)}_defineService(e,t,s){const i=e.ports,o={};for(const c in i)o[c]=this._definePort(i[c],t||i[c].location,s);return o}_definePort(e,t,s){const{binding:{methods:i}}=e,o={};for(const c in i){const l=`${c}Async`;if(o[c]=this._defineMethod(i[c],t),o[l]=this._defineMethodAsync(i[c],t),this[c]&&!s)throw new Error(`Method with name ${c} already exists`);if(this[l]&&!s)throw new Error(`Method with name ${l} already exists`);this[l]=o[l],this[c]=o[c]}return o}_defineMethod(e,t){return async(s,i)=>{await this._invoke(e,s,t).then(o=>{i(o)})}}_defineMethodAsync(e,t){return async s=>await this._invoke(e,s,t)}async _invoke(e,t,s){var H,L;const{name:i,input:o}=e,c=this.wsdl.definitions,l=c.$targetNamespace;let u="",m=null;const d={SOAPAction:this.SOAPAction?this.SOAPAction(l,i):`${l.lastIndexOf("/")!==l.length-1?`${l}/`:l}${i}`,"Content-Type":"text/xml; charset=utf-8"},_=t.Headers,R={},A=ge(c.xmlns,l);delete t.Headers,(H=this.security)!=null&&H.addHeaders&&this.security.addHeaders(d),(L=this.security)!=null&&L.addOptions&&this.security.addOptions(R);const S=this.security?this.wsdl.objectToXML(this.security,null,A,void 0):"",p=_?this.wsdl.complexObjectToXML(_,null):"";u=this.wsdl.objectToDocumentXML(o.$name,t,o.targetNSAlias,o.targetNamespace),m=`<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" ${this.wsdl.xmlnsInEnvelope}><soap:Header>${S}${p}</soap:Header><soap:Body>`+u+"</soap:Body></soap:Envelope>";const x=await(await ne(s,m)).text();return this.wsdl.xmlToObject(x)}}let G,J,W,P,te,V,U,r=function(n){n=E.replace(n,null,null,`\r
`,`
`),n=E.replace(n,null,null,"\r",`
`),this.m_xml=n,this.m_iP=0,this.m_iState=r._STATE_PROLOG,this.m_stack=new Q,this._clearAttributes(),this.m_pause=!1,this.m_preInterruptIState=r._STATE_PROLOG,this.m_namespaceList=new Array,this.m_chunkTransitionContinuation=null};r._NONE=0;r._ELM_B=1;r._ELM_E=2;r._ELM_EMP=3;r._ATT=4;r._TEXT=5;r._ENTITY=6;r._PI=7;r._CDATA=8;r._COMMENT=9;r._DTD=10;r._ERROR=11;r._INTERRUPT=12;r._CONT_XML=0;r._CONT_ALT=1;r._ATT_NAME=0;r._ATT_VAL=1;r._STATE_PROLOG=1;r._STATE_DOCUMENT=2;r._STATE_MISC=3;r._errs=new Array;r.ERR_CLOSE_PI=0;r.ERR_CLOSE_DTD=1;r.ERR_CLOSE_COMMENT=2;r.ERR_CLOSE_CDATA=3;r.ERR_CLOSE_ELM=4;r.ERR_CLOSE_ENTITY=5;r.ERR_PI_TARGET=6;r.ERR_ELM_EMPTY=7;r.ERR_ELM_NAME=8;r.ERR_ELM_LT_NAME=9;r.ERR_ATT_VALUES=10;r.ERR_ATT_LT_NAME=11;r.ERR_ATT_LT_VALUE=12;r.ERR_ATT_DUP=13;r.ERR_ENTITY_UNKNOWN=14;r.ERR_INFINITELOOP=15;r.ERR_DOC_STRUCTURE=16;r.ERR_ELM_NESTING=17;r._errs[r.ERR_CLOSE_PI]="PI: missing closing sequence";r._errs[r.ERR_CLOSE_DTD]="DTD: missing closing sequence";r._errs[r.ERR_CLOSE_COMMENT]="Comment: missing closing sequence";r._errs[r.ERR_CLOSE_CDATA]="CDATA: missing closing sequence";r._errs[r.ERR_CLOSE_ELM]="Element: missing closing sequence";r._errs[r.ERR_CLOSE_ENTITY]="Entity: missing closing sequence";r._errs[r.ERR_PI_TARGET]="PI: target is required";r._errs[r.ERR_ELM_EMPTY]="Element: cannot be both empty and closing";r._errs[r.ERR_ELM_NAME]='Element: name must immediatly follow "<"';r._errs[r.ERR_ELM_LT_NAME]='Element: "<" not allowed in element names';r._errs[r.ERR_ATT_VALUES]="Attribute: values are required and must be in quotes";r._errs[r.ERR_ATT_LT_NAME]='Element: "<" not allowed in attribute names';r._errs[r.ERR_ATT_LT_VALUE]='Attribute: "<" not allowed in attribute values';r._errs[r.ERR_ATT_DUP]="Attribute: duplicate attributes not allowed";r._errs[r.ERR_ENTITY_UNKNOWN]="Entity: unknown entity";r._errs[r.ERR_INFINITELOOP]="Infininte loop";r._errs[r.ERR_DOC_STRUCTURE]="Document: only comments, processing instructions, or whitespace allowed outside of document element";r._errs[r.ERR_ELM_NESTING]="Element: must be nested correctly";r.prototype.continueParsing=function(n){this.m_chunkTransitionContinuation&&(n=this.m_chunkTransitionContinuation+n),n=E.replace(n,null,null,`\r
`,`
`),n=E.replace(n,null,null,"\r",`
`),this.m_xml=n,this.m_iP=0,this.m_iState=r._STATE_DOCUMENT,this.m_pause=!1,this.m_preInterruptIState=r._STATE_PROLOG,this.m_chunkTransitionContinuation=null};r.prototype._addAttribute=function(n,e){this.m_atts[this.m_atts.length]=new Array(n,e)};r.prototype._checkStructure=function(n){if(r._STATE_PROLOG==this.m_iState){if((r._TEXT==n||r._ENTITY==n)&&E.indexOfNonWhitespace(this.getContent(),this.getContentBegin(),this.getContentEnd())!=-1)return this._setErr(r.ERR_DOC_STRUCTURE);(r._ELM_B==n||r._ELM_EMP==n)&&(this.m_iState=r._STATE_DOCUMENT)}if(r._STATE_DOCUMENT==this.m_iState){if((r._ELM_B==n||r._ELM_EMP==n)&&this.m_stack.push(this.getName()),r._ELM_E==n||r._ELM_EMP==n){let e=this.m_stack.pop();if(e==null||e!=this.getName())return this._setErr(r.ERR_ELM_NESTING)}if(this.m_stack.count()==0)return this.m_iState=r._STATE_MISC,n}if(r._STATE_MISC==this.m_iState){if(r._ELM_B==n||r._ELM_E==n||r._ELM_EMP==n||r.EVT_DTD==n)return this._setErr(r.ERR_DOC_STRUCTURE);if((r._TEXT==n||r._ENTITY==n)&&E.indexOfNonWhitespace(this.getContent(),this.getContentBegin(),this.getContentEnd())!=-1)return this._setErr(r.ERR_DOC_STRUCTURE)}return n};r.prototype._clearAttributes=function(){this.m_atts=new Array};r.prototype._findAttributeIndex=function(n){for(let e=0;e<this.m_atts.length;e++)if(this.m_atts[e][r._ATT_NAME]==n)return e;return-1};r.prototype.getAttributeCount=function(){return this.m_atts?this.m_atts.length:0};r.prototype.getAttributeName=function(n){return n<0||n>=this.m_atts.length?null:this.m_atts[n][r._ATT_NAME]};r.prototype.getAttributeValue=function(n){return n<0||n>=this.m_atts.length?null:Ce(this.m_atts[n][r._ATT_VAL])};r.prototype.getAttributeValueByName=function(n){return this.getAttributeValue(this._findAttributeIndex(n))};r.prototype.getColumnNumber=function(){return E.getColumnNumber(this.m_xml,this.m_iP)};r.prototype.getContent=function(){return this.m_cSrc==r._CONT_XML?this.m_xml:this.m_cAlt};r.prototype.getContentBegin=function(){return this.m_cB};r.prototype.getContentEnd=function(){return this.m_cE};r.prototype.getLineNumber=function(){return E.getLineNumber(this.m_xml,this.m_iP)};r.prototype.getName=function(){return this.m_name};r.prototype.pause=function(){this.m_pause=!0};r.prototype.resume=function(){this.m_pause=!1,this.m_iState=this.m_preInterruptIState};r.prototype.next=function(){return this.m_pause?(this.m_preInterruptIState=this.m_iState,r._INTERRUPT):this._checkStructure(this._parse())};r.prototype._parse=function(){if(this.m_iP==this.m_xml.length)return r._NONE;function n(t,s,i){for(let o=0;o<t.length;o++)if(t.charAt(o)!=s.charAt(i+o))return-1;return i}let e=this.m_xml.charAt(this.m_iP);return e!=="<"&&e!=="&"?this._parseText(this.m_iP):this.m_iP==n("<?",this.m_xml,this.m_iP)?this._parsePI(this.m_iP+2):this.m_iP==n("<!DOCTYPE",this.m_xml,this.m_iP)?this._parseDTD(this.m_iP+9):this.m_iP==n("<!--",this.m_xml,this.m_iP)?this._parseComment(this.m_iP+4):this.m_iP==n("<![CDATA[",this.m_xml,this.m_iP)?this._parseCDATA(this.m_iP+9):this.m_iP==n("<",this.m_xml,this.m_iP)?this._parseElement(this.m_iP+1):this.m_iP==n("&",this.m_xml,this.m_iP)?this._parseEntity(this.m_iP+1):this._parseText(this.m_iP)};r.prototype._parsePrefixAndElementName=function(n){return W=n.split(":",2),{prefix:W.length===1?"":W[0],name:W.length===1?n:W[1]}};r.prototype._parseNamespacesAndAtts=function(n){te=this;let e=[],t=[];return n.map(function(s){return s[0].slice(0,5)==="xmlns"?e.push({prefix:s[0].slice(6),uri:s[1],scopetag:te.m_name}):t.push(s),"not used"}),this.m_namespaceList=this.m_namespaceList.concat(e),[t,e.map(function(s){return[s.prefix,s.uri]})]};r.prototype._getContextualNamespace=function(n){if(n!=="")for(let e in this.m_namespaceList){const t=this.m_namespaceList[e];if(t.prefix===n)return t.uri}for(let e=this.m_namespaceList.length-1;e>=0;e--){const t=this.m_namespaceList[e];if(t.prefix==="")return t.uri}return""};r.prototype._removeExpiredNamesapces=function(n){const e=[];this.m_namespaceList.map(function(t){t.scopetag!==n&&e.push(t)}),this.m_namespaceList=e};r.prototype._parseAttribute=function(n,e){let t,s,i,o,c,l,u,m;if(this.m_cAlt="",t=E.indexOfNonWhitespace(this.m_xml,n,e),t==-1||t>=e)return t;if(i=this.m_xml.indexOf("=",t),i==-1||i>e)return this._setErr(r.ERR_ATT_VALUES);if(s=E.lastIndexOfNonWhitespace(this.m_xml,t,i),o=E.indexOfNonWhitespace(this.m_xml,i+1,e),o==-1||o>e)return this._setErr(r.ERR_ATT_VALUES);if(l=this.m_xml.charAt(o),E.QUOTES.indexOf(l)==-1)return this._setErr(r.ERR_ATT_VALUES);if(c=this.m_xml.indexOf(l,o+1),c==-1||c>e)return this._setErr(r.ERR_ATT_VALUES);if(u=this.m_xml.substring(t,s+1),m=this.m_xml.substring(o+1,c),u.indexOf("<")!=-1)return this._setErr(r.ERR_ATT_LT_NAME);if(m.indexOf("<")!=-1)return this._setErr(r.ERR_ATT_LT_VALUE);if(m=E.replace(m,null,null,`
`," "),m=E.replace(m,null,null,"	"," "),G=this._replaceEntities(m),G==r._ERROR)return G;if(m=this.m_cAlt,this._findAttributeIndex(u)==-1)this._addAttribute(u,m);else return this._setErr(r.ERR_ATT_DUP);return this.m_iP=c+2,r._ATT};r.prototype._parseCDATA=function(n){const e=this.m_xml.indexOf("]]>",n);return e==-1?(this.m_chunkTransitionContinuation=this.m_xml.slice(n-9),r._INTERRUPT):(this._setContent(r._CONT_XML,n,e),this.m_iP=e+3,r._CDATA)};r.prototype._parseComment=function(n){const e=this.m_xml.indexOf("-->",n);return e==-1?(this.m_chunkTransitionContinuation=this.m_xml.slice(n-4),r._INTERRUPT):(this._setContent(r._CONT_XML,n,e),this.m_iP=e+3,r._COMMENT)};r.prototype._parseDTD=function(n){let e,t,s,i;if(e=this.m_xml.indexOf(">",n),e==-1)return this.m_chunkTransitionContinuation=this.m_xml.slice(n-9),r._INTERRUPT;for(s=this.m_xml.indexOf("[",n),t=s!=-1&&s<e?"]>":">";;){if(e==i)return this._setErr(r.ERR_INFINITELOOP);if(i=e,e=this.m_xml.indexOf(t,n),e==-1)return this._setErr(r.ERR_CLOSE_DTD);if(this.m_xml.substring(e-1,e+2)!="]]>")break}return this.m_iP=e+t.length,r._DTD};r.prototype._parseElement=function(n){let e,t,s,i,o,c,l;if(t=e=this.m_xml.indexOf(">",n),e==-1)return this.m_chunkTransitionContinuation=this.m_xml.slice(n-1),r._INTERRUPT;if(this.m_xml.charAt(n)=="/"?(o=r._ELM_E,n++):o=r._ELM_B,this.m_xml.charAt(e-1)=="/"){if(o==r._ELM_E)return this._setErr(r.ERR_ELM_EMPTY);o=r._ELM_EMP,t--}if(t=E.lastIndexOfNonWhitespace(this.m_xml,n,t),e-n!=1&&E.indexOfNonWhitespace(this.m_xml,n,t)!=n)return this._setErr(r.ERR_ELM_NAME);if(this._clearAttributes(),s=E.indexOfWhitespace(this.m_xml,n,t),s==-1)s=t+1;else for(this.m_iP=s;this.m_iP<t;){if(this.m_iP==l)return this._setErr(r.ERR_INFINITELOOP);if(l=this.m_iP,i=this._parseAttribute(this.m_iP,t),i==r._ERROR)return i}return c=this.m_xml.substring(n,s),c.indexOf("<")!=-1?this._setErr(r.ERR_ELM_LT_NAME):(this.m_name=c,this.m_iP=e+1,o)};r.prototype._parseEntity=function(n){const e=this.m_xml.indexOf(";",n);return e==-1?(this.m_chunkTransitionContinuation=this.m_xml.slice(n-1),r._INTERRUPT):(this.m_iP=e+1,this._replaceEntity(this.m_xml,n,e))};r.prototype._parsePI=function(n){let e,t,s,i,o;return e=this.m_xml.indexOf("?>",n),e==-1?(this.m_chunkTransitionContinuation=this.m_xml.slice(n-2),r._INTERRUPT):(t=E.indexOfNonWhitespace(this.m_xml,n,e),t==-1?this._setErr(r.ERR_PI_TARGET):(s=E.indexOfWhitespace(this.m_xml,t,e),s==-1&&(s=e),i=E.indexOfNonWhitespace(this.m_xml,s,e),i==-1&&(i=e),o=E.lastIndexOfNonWhitespace(this.m_xml,i,e),o==-1&&(o=e-1),this.m_name=this.m_xml.substring(t,s),this._setContent(r._CONT_XML,i,o+1),this.m_iP=e+2,r._PI))};r.prototype._parseText=function(n){let e,t;for(e=n;e<this.m_xml.length&&(t=this.m_xml.charAt(e),!(t==="<"||t==="&"));++e);return this._setContent(r._CONT_XML,n,e),this.m_iP=e,r._TEXT};r.prototype._replaceEntities=function(n,e,t){if(E.isEmpty(n))return"";e=e||0,t=t||n.length;var s,i,o="";for(s=n.indexOf("&",e),i=e;s>0&&s<t;){if(o+=n.substring(i,s),i=n.indexOf(";",s)+1,i==0||i>t)return this._setErr(r.ERR_CLOSE_ENTITY);if(G=this._replaceEntity(n,s+1,i-1),G==r._ERROR)return G;o+=this.m_cAlt,s=n.indexOf("&",i)}return i!=t&&(o+=n.substring(i,t)),this._setContent(r._CONT_ALT,o),r._ENTITY};r.prototype._replaceEntity=function(n,e,t){if(E.isEmpty(n))return-1;switch(e=e||0,t=t||n.length,n.substring(e,t)){case"amp":U="&";break;case"lt":U="<";break;case"gt":U=">";break;case"apos":U="'";break;case"quot":U='"';break;case"nbsp":U="";break;case"cent":U="¢";break;case"pound":U="£";break;case"yen":U="¥";break;case"euro":U="€";break;case"sect":U="§";break;case"copy":U="©";break;case"reg":U="®";break;default:n.charAt(e)=="#"?U=String.fromCharCode(parseInt(n.substring(e+1,t))):U=" ";break}return this._setContent(r._CONT_ALT,U),r._ENTITY};r.prototype._setContent=function(n){const e=arguments;r._CONT_XML==n?(this.m_cAlt=null,this.m_cB=e[1],this.m_cE=e[2]):(this.m_cAlt=e[1],this.m_cB=0,this.m_cE=e[1].length),this.m_cSrc=n};r.prototype._setErr=function(n){const e=r._errs[n];return this.m_cAlt=e,this.m_cB=0,this.m_cE=e.length,this.m_cSrc=r._CONT_ALT,r._ERROR};const f=function(n){const e=new function(){},t=new Function;t.prototype.onStartDocument=function(s){e.onStartDocument=s},t.prototype.onEndDocument=function(s){e.onEndDocument=s},t.prototype.onStartElementNS=function(s){e.onStartElementNS=s},t.prototype.onEndElementNS=function(s){e.onEndElementNS=s},t.prototype.onCharacters=function(s){e.onCharacters=s},t.prototype.onCdata=function(s){e.onCdata=s},t.prototype.onComment=function(s){e.onComment=s},t.prototype.onWarning=function(s){e.onWarning=s},t.prototype.onError=function(s){e.onError=s},n(new t),this.m_hndDoc=e,this.m_hndErr=e,this.m_hndLex=e,this.m_interrupted=!1};f.DOC_B=1;f.DOC_E=2;f.ELM_B=3;f.ELM_E=4;f.CHARS=5;f.PI=6;f.CD_B=7;f.CD_E=8;f.CMNT=9;f.DTD_B=10;f.DTD_E=11;f.prototype.parseString=function(n){const e=this;let t=!0;e.m_parser?e.m_parser.continueParsing(n):(e.m_parser=new r(n),t=!1),e.m_bErr=!1,!e.m_bErr&&!t&&e._fireEvent(f.DOC_B),e._parseLoop(),!e.m_bErr&&!e.m_interrupted&&e._fireEvent(f.DOC_E),e.m_xml=null,e.m_iP=0,e.m_interrupted=!1};f.prototype.pause=function(){this.m_parser.pause()};f.prototype.resume=function(){this.m_parser.resume(),this.m_interrupted=!1;const n=this;setTimeout(function(){n._parseLoop(),!n.m_bErr&&!n.m_interrupted&&n._fireEvent(f.DOC_E)},0)};f.prototype.setDocumentHandler=function(n){this.m_hndDoc=n};f.prototype.setErrorHandler=function(n){this.m_hndErr=n};f.prototype.setLexicalHandler=function(n){this.m_hndLex=n};f.prototype.getColumnNumber=function(){return this.m_parser.getColumnNumber()};f.prototype.getLineNumber=function(){return this.m_parser.getLineNumber()};f.prototype.getMessage=function(){return this.m_strErrMsg};f.prototype.getPublicId=function(){return null};f.prototype.getSystemId=function(){return null};f.prototype.getLength=function(){return this.m_parser.getAttributeCount()};f.prototype.getName=function(n){return this.m_parser.getAttributeName(n)};f.prototype.getValue=function(n){return this.m_parser.getAttributeValue(n)};f.prototype.getValueByName=function(n){return this.m_parser.getAttributeValueByName(n)};f.prototype._fireError=function(n){var e;this.m_strErrMsg=n,this.m_bErr=!0,(e=this.m_hndErr)!=null&&e.onError&&this.m_hndErr.onError(this.m_strErrMsg)};f.prototype._fireEvent=function(n){let e,t,s=arguments,i=s.length-1;this.m_bErr||(f.DOC_B==n?(t="onStartDocument",e=this.m_hndDoc):f.DOC_E==n?(t="onEndDocument",e=this.m_hndDoc):f.ELM_B==n?(t="onStartElementNS",e=this.m_hndDoc):f.ELM_E==n?(t="onEndElementNS",e=this.m_hndDoc):f.CHARS==n?(t="onCharacters",e=this.m_hndDoc):f.PI==n?(t="processingInstruction",e=this.m_hndDoc):f.CD_B==n?(t="onCdata",e=this.m_hndLex):f.CD_E==n?(t="onEndCDATA",e=this.m_hndLex):f.CMNT==n&&(t="onComment",e=this.m_hndLex),e!=null&&e[t]&&(i==0?e[t]():i==1?e[t](s[1]):i==2?e[t](s[1],s[2]):i==3?e[t](s[1],s[2],s[3]):i==4?e[t](s[1],s[2],s[3],s[4]):i==5?e[t](s[1],s[2],s[3],s[4],s[5]):i==6&&e[t](s[1],s[2],s[3],s[4],s[5],s[6])))};f.prototype._parseLoop=function(){let n,e;for(e=this.m_parser;!this.m_bErr;)if(n=e.next(),n==r._ELM_B){J=this.m_parser.m_atts,P=e._parsePrefixAndElementName(e.getName()),V=e._parseNamespacesAndAtts(J);const t=e._getContextualNamespace(P.prefix);this._fireEvent(f.ELM_B,P.name,V[0],P.prefix===""?null:P.prefix,t===""?null:t,V[1])}else if(n==r._ELM_E){P=e._parsePrefixAndElementName(e.getName());const t=e._getContextualNamespace(P.prefix);e._removeExpiredNamesapces(e.getName()),this._fireEvent(f.ELM_E,P.name,P.prefix===""?null:P.prefix,t===""?null:t)}else if(n==r._ELM_EMP){J=this.m_parser.m_atts,P=e._parsePrefixAndElementName(e.getName()),V=e._parseNamespacesAndAtts(J);const t=e._getContextualNamespace(P.prefix);this._fireEvent(f.ELM_B,P.name,V[0],P.prefix===""?null:P.prefix,t===""?null:t,V[1],!0),e._removeExpiredNamesapces(e.getName()),this._fireEvent(f.ELM_E,P.name,P.prefix===""?null:P.prefix,t===""?null:t,!0)}else if(n==r._TEXT)this._fireEvent(f.CHARS,e.getContent().slice(e.getContentBegin(),e.getContentEnd()));else if(n==r._ENTITY)this._fireEvent(f.CHARS,e.getContent(),e.getContentBegin(),e.getContentEnd()-e.getContentBegin());else if(n==r._PI)this._fireEvent(f.PI,e.getName(),e.getContent().substring(e.getContentBegin(),e.getContentEnd()));else if(n==r._CDATA)this._fireEvent(f.CD_B,e.getContent().slice(e.getContentBegin(),e.getContentEnd()));else if(n==r._COMMENT)this._fireEvent(f.CMNT,e.getContent().slice(e.getContentBegin(),e.getContentEnd()));else{if(n==r._DTD)return;if(n==r._ERROR)this._fireError(e.getContent());else if(n==r._INTERRUPT){this.m_interrupted=!0;return}else if(n==r._NONE)return}};const E=function(){};E.WHITESPACE=` 	
\r`;E.QUOTES=`"'`;E.getColumnNumber=function(n,e){if(E.isEmpty(n))return-1;e=e||n.length;const t=n.substring(0,e).split(`
`);t.length--;const s=t.join(`
`).length;return e-s};E.getLineNumber=function(n,e){return E.isEmpty(n)?-1:(e=e||n.length,n.substring(0,e).split(`
`).length)};E.indexOfNonWhitespace=function(n,e,t){if(E.isEmpty(n))return-1;e=e||0,t=t||n.length;for(let s=e;s<t;s++)if(E.WHITESPACE.indexOf(n.charAt(s))==-1)return s;return-1};E.indexOfWhitespace=function(n,e,t){if(E.isEmpty(n))return-1;e=e||0,t=t||n.length;for(var s=e;s<t;s++)if(E.WHITESPACE.indexOf(n.charAt(s))!=-1)return s;return-1};E.isEmpty=function(n){return n==null||n.length==0};E.lastIndexOfNonWhitespace=function(n,e,t){if(E.isEmpty(n))return-1;e=e||0,t=t||n.length;for(var s=t-1;s>=e;s--)if(E.WHITESPACE.indexOf(n.charAt(s))==-1)return s;return-1};E.replace=function(n,e,t,s,i){return E.isEmpty(n)?"":(e=e||0,t=t||n.length,n.toString().substring(e,t).split(s).join(i))};const Q=function(){this.m_arr=new Array};Q.prototype.clear=function(){this.m_arr=new Array};Q.prototype.count=function(){return this.m_arr.length};Q.prototype.destroy=function(){this.m_arr=null};Q.prototype.peek=function(){return this.m_arr.length==0?null:this.m_arr[this.m_arr.length-1]};Q.prototype.pop=function(){if(this.m_arr.length==0)return null;const n=this.m_arr[this.m_arr.length-1];return this.m_arr.length--,n};Q.prototype.push=function(n){this.m_arr[this.m_arr.length]=n};function Ce(n){const e=/&lt;/g,t=/&gt;/g,s=/&quot;/g,i=/&apos;/g;return n=n.replace(e,"<"),n=n.replace(t,">"),n=n.replace(s,'"'),n=n.replace(i,"'"),n=n.replace(/&amp;/g,"&"),n}const se={SaxParser:f},ie={string:1,boolean:1,decimal:1,float:1,double:1,anyType:1,byte:1,int:1,long:1,short:1,unsignedByte:1,unsignedInt:1,unsignedLong:1,unsignedShort:1,duration:0,dateTime:0,time:0,date:0,gYearMonth:0,gYear:0,gMonthDay:0,gDay:0,gMonth:0,hexBinary:0,base64Binary:0,anyURI:0,QName:0,NOTATION:0};function $(n){const e=n!=null?n.indexOf(":"):-1;return e<0?{namespace:null,name:n}:{namespace:n.substring(0,e),name:n.substring(e+1)}}class N{constructor(e,t,s){y(this,"nsName");y(this,"namespace");y(this,"name");y(this,"children");y(this,"xmlns");y(this,"allowedChildren",{});y(this,"allowedChildrenList","_fault");const i=$(e);this.nsName=e,this.namespace=i.namespace??"",this.name=i.name,this.children=[],this.xmlns={};for(const o in t){const c=/^xmlns:?(.*)$/.exec(o);c?this.xmlns[c[1]]=t[o]:this["$"+o]=t[o]}this.allowedChildrenList=s??this.allowedChildrenList,this._parseAllowedTypes()}_parseAllowedTypes(){this.allowedChildrenList.split(" ").forEach(t=>{this.allowedChildren[t.replace(/^_/,"")]=(w[t]||[N])[0]})}deleteFixedAttrs(){this.children&&this.children.length===0&&delete this.children,this.xmlns&&Object.keys(this.xmlns).length===0&&delete this.xmlns,delete this.nsName,delete this.namespace,delete this.name}startElement(e,t,s){if(!this.allowedChildren)return;const i=this.allowedChildren[$(t).name];i?e.push(new i(t,s)):this.unexpected(t)}endElement(e,t){var s;if(this.nsName===t){if(e.length<2)return;const i=e[e.length-2];this!==e[0]&&(e[0].xmlns={...e[0].xmlns,...this.xmlns},(s=i.children)==null||s.push(this),i.addChild(this))}e.pop()}addChild(e){}unexpected(e){throw new Error(`Found unexpected element (${e}) inside ${this.nsName??""}`)}description(e){return this.$name||this.name}}class Ne extends N{constructor(e,t){const s=w.element[1];super(e,t,s)}description(e){const t={};let s=this.$name;if(this.$minOccurs!==this.$maxOccurs&&(s+="[]"),this.$type){const i=$(this.$type).name,o=e.xmlns[$(this.$type).namespace??""],c=e.schemas[o],l=c&&(c.complexTypes[i]||c.types[i]);l&&!(i in ie)?t[s]=l.description(e):t[s]=this.$type}else{const i=this.children??[];t[s]={};for(let o=0,c;c=i[o];o++)c instanceof re&&(t[s]=c.description(e))}return t}}class re extends N{constructor(e,t){const s=w.complexType[1];super(e,t,s)}description(e){const t=this.children??[];for(let s=0,i;i=t[s];s++)if(i instanceof ae||i instanceof oe)return i.description(e);return{}}}class oe extends N{constructor(e,t){const s=w.all[1];super(e,t,s)}description(e){const t=this.children??[],s={};for(let i=0,o;o=t[i];i++){const c=o.description(e);for(const l in c)s[l]=c[l]}return s}}class ae extends N{constructor(e,t){const s=w.sequence[1];super(e,t,s)}description(e){const t=this.children??[],s={};for(let i=0,o;o=t[i];i++){const c=o.description(e);for(const l in c)s[l]=c[l]}return s}}class ce extends N{constructor(t,s){const i=w.types[1];super(t,s,i);y(this,"schemas");this.schemas={}}addChild(t){t.$targetNamespace?this.schemas[t.$targetNamespace]=t:this.schemas[t.includes[0].namespace]=t}}class le extends N{constructor(t,s){const i=w.schema[1];super(t,s,i);y(this,"complexTypes");y(this,"types");y(this,"elements");y(this,"includes");this.complexTypes={},this.types={},this.elements={},this.includes=[]}addChild(t){var s;if(!(t.$name in ie)){if(t.name==="include"||t.name==="import"){const i=t.$schemaLocation||t.$location;i&&this.includes.push({namespace:t.$namespace||t.$targetNamespace||this.$targetNamespace,location:i})}else t.name==="complexType"?this.complexTypes[t.$name]=t:t.name==="element"?this.elements[t.$name]=t:t.$name&&(this.types[t.$name]=t);(s=this.children)==null||s.pop()}}}class be extends N{constructor(e,t){const s=w.simpleType[1];super(e,t,s)}description(){const e=this.children??[];for(let t=0,s;s=e[t];t++)if(s instanceof he)return`${this.$name} | ${s.description()}`;return{}}}class he extends N{constructor(e,t){const s=w.restriction[1];super(e,t,s)}description(){return(this.$base?`${this.$base}|`:"")+(this.children??[]).map(function(t){return t.description()}).join(",")}}class Se extends N{constructor(e,t){const s=w.enumeration[1];super(e,t,s)}description(){return this.$value}}class ue extends N{constructor(t,s){const i=w.service[1];super(t,s,i);y(this,"ports");this.ports={}}description(t){const s={};for(const i in this.ports){const o=this.ports[i];s[i]=o.binding.description(t)}return s}postProcess(t){const s=this.children??[],i=t.bindings;for(let o=0,c;c=s[o];o++){if(c.name!=="port")continue;const l=$(c.$binding).name,u=i[l];u&&(u.postProcess(t),this.ports[c.$name]={location:c.location,binding:u},s.splice(o--,1))}delete this.$name,this.deleteFixedAttrs()}}class Me extends N{constructor(t,s){const i=w.port[1];super(t,s,i);y(this,"location");this.location=null}addChild(t){t.name==="address"&&typeof t.$location<"u"&&(this.location=t.$location)}}class pe extends N{constructor(t,s){const i=w.binding[1];super(t,s,i);y(this,"transport");y(this,"style");y(this,"methods");this.transport="",this.style="",this.methods={}}addChild(t){var s;t.name==="binding"&&(this.transport=t.$transport,this.style=t.$style,(s=this.children)==null||s.pop())}postProcess(t){var l,u;const s=$(this.$type).name,i=t.portTypes[s],o=this.style,c=this.children??[];i.postProcess(t),this.methods=i.methods;for(let m=0,d;d=c[m];m++){if(d.name!=="operation")continue;d.postProcess(t,"binding"),c.splice(m--,1),d.style||(d.style=o);const _=this.methods[d.$name];_.style=d.style,_.soapAction=d.soapAction,_.inputSoap=d.input||null,_.outputSoap=d.output||null,(l=_.inputSoap)==null||l.deleteFixedAttrs(),(u=_.outputSoap)==null||u.deleteFixedAttrs()}delete this.$name,delete this.$type,this.deleteFixedAttrs()}description(t){const s={};for(const i in this.methods){const o=this.methods[i];s[i]=o.description(t)}return s}}class me extends N{constructor(t,s){const i=w.portType[1];super(t,s,i);y(this,"methods");this.methods={}}postProcess(t){const s=this.children;if(!(typeof s>"u")){for(let i=0,o;o=s[i];i++)o.name==="operation"&&(o.postProcess(t,"portType"),this.methods[o.$name]=o,s.splice(i--,1));delete this.$name,this.deleteFixedAttrs()}}description(t){const s={};for(const i in this.methods){const o=this.methods[i];s[i]=o.description(t)}return s}}class fe extends N{constructor(t,s){const i=w.message[1];super(t,s,i);y(this,"element");y(this,"parts");this.element=null,this.parts=null}postProcess(t){var c,l;let s=null,i;const o=this.children??[];for(let u=0;u<o.length;u++)if((i=o[u]).name==="part"){s=i;break}if(s){if(s.$element){delete this.parts;const u=$(s.$element),m=u.namespace??"";this.element=t.schemas[t.xmlns[m]].elements[u.name],this.element.targetNSAlias=m,this.element.targetNamespace=t.xmlns[m],(c=this.children)==null||c.splice(0,1)}else{this.parts={},delete this.element;for(let u=0,m;m=o[u];u++){const d=$(s.$type),_=t.xmlns[d.namespace??""],R=d.name;typeof t.schemas[_]<"u"?this.parts[m.$name]=t.schemas[_].types[R]||t.schemas[_].complexTypes[R]:this.parts[m.$name]=m.$type,this.parts[m.$name].namespace=d.namespace,this.parts[m.$name].xmlns=_,(l=this.children)==null||l.splice(u--,1)}}this.deleteFixedAttrs()}}description(t){var i;if(this.element)return(i=this.element)==null?void 0:i.description(t);const s={};return s[this.$name]=this.parts,s}}class we extends N{constructor(e,t){const s=w.operation[1];super(e,t,s),this.input=null,this.output=null,this.inputSoap=null,this.outputSoap=null,this.style="",this.soapAction=""}postProcess(e,t){const s=this.children??[];for(let i=0,o;o=s[i];i++){if(o.name!=="input"&&o.name!=="output")continue;if(t==="binding"){this[o.name]=o,s.splice(i--,1);continue}const c=$(o.$message).name,l=e.messages[c];l.postProcess(e),l.element?(e.messages[l.element.$name]=l,this[o.name]=l.element):this[o.name]=l,s.splice(i--,1)}this.deleteFixedAttrs()}description(e){const t=this.input.description(e),s=this.output.description(e);return{input:t==null?void 0:t[Object.keys(t)[0]],output:s==null?void 0:s[Object.keys(s)[0]]}}addChild(e){var t;e.name==="operation"&&(this.soapAction=e.$soapAction||"",this.style=e.$style||"",(t=this.children)==null||t.pop())}}class Le extends N{constructor(e,t){const s=w.input[1];super(e,t,s)}addChild(e){var t;e.name==="body"&&(this.use=e.$use,this.use==="encoded"&&(this.encodingStyle=e.$encodingStyle),(t=this.children)==null||t.pop())}}class Pe extends N{constructor(e,t){const s=w.output[1];super(e,t,s)}addChild(e){var t;e.name==="body"&&(this.use=e.$use,this.use==="encoded"&&(this.encodingStyle=e.$encodingStyle),(t=this.children)==null||t.pop())}}class _e extends N{constructor(t,s){const i=w.definitions[1];super(t,s,i);y(this,"messages");y(this,"portTypes");y(this,"bindings");y(this,"services");y(this,"schemas");this.name!=="definitions"&&this.unexpected(this.nsName??""),this.messages={},this.portTypes={},this.bindings={},this.services={},this.schemas={}}addChild(t){var s;t instanceof ce?this.schemas=t.schemas:t instanceof fe?this.messages[t.$name]=t:t instanceof me?this.portTypes[t.$name]=t:t instanceof pe?(t.transport==="http://schemas.xmlsoap.org/soap/http"||t.transport==="http://www.w3.org/2003/05/soap/bindings/HTTP/")&&(this.bindings[t.$name]=t):t instanceof ue&&(this.services[t.$name]=t),(s=this.children)==null||s.pop()}}const w={types:[ce,"schema"],schema:[le,"element complexType simpleType include import"],element:[Ne,"annotation complexType"],simpleType:[be,"restriction"],restriction:[he,"enumeration"],enumeration:[Se,""],complexType:[re,"annotation sequence all"],sequence:[ae,"element"],all:[oe,"element"],service:[ue,"port documentation"],port:[Me,"address"],binding:[pe,"_binding SecuritySpec operation"],portType:[me,"operation"],message:[fe,"part documentation"],operation:[we,"documentation input output fault _operation"],input:[Le,"body SecuritySpecRef documentation header"],output:[Pe,"body SecuritySpecRef documentation header"],fault:[N,"_fault"],definitions:[_e,"types message portType binding service"]};function Ie(n){return typeof n=="string"?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):n}const Oe=/^[\s\xA0]+/,Ue=/[\s\xA0]+$/;function De(n){return n.replace(Oe,"").replace(Ue,"")}class $e{constructor(e,t,s={}){y(this,"uri");y(this,"options");y(this,"xml","");y(this,"definitions",{});y(this,"services",{});y(this,"xmlnsInEnvelope","");y(this,"readyPromise");y(this,"readyPromiseResolveFn");let i=o=>{};if(this.uri=t,this.options=s,this.readyPromise=new Promise(o=>{i=o}),this.readyPromiseResolveFn=i,typeof e!="string")throw new Error("WSDL constructor takes an XML string");this._fromXML(e),this.processIncludes().then(()=>{this.definitions.deleteFixedAttrs();const o=this.services=this.definitions.services;if(o)for(const u in o)o[u].postProcess(this.definitions);const c=this.definitions.complexTypes;if(c)for(const u in c)c[u].deleteFixedAttrs();const l=this.definitions.bindings;for(const u in l){const m=l[u];if(m.style!=="document")continue;const d=m.methods;m.topElements={};for(const _ in d){const R=d[_].input.$name,A=d[_].output.$name;m.topElements[R]={methodName:_,outputName:A}}}this.xmlnsInEnvelope=this.xmlnsMap(),this.readyPromiseResolveFn(null)}).catch(()=>{})}_fromXML(e){this.definitions=this._parse(e),this.xml=e}_parse(e){let t;const s=new se.SaxParser(function(c){t=c}),i=[];let o=null;return t.onStartElementNS((c,l,u,m,d)=>{c=u?u+":"+c:c;const _=l.reduce(function(A,S){return A[S[0]]=S[1],A},{});d.forEach(function(A){const S=A[0],p=A[1];_["xmlns"+(S?":":"")+S]=p});const R=i[i.length-1];if(R)try{R.startElement(i,c,_)}catch(A){if(this.options.strict)throw A;i.push(new N(c,_))}else{const A=$(c).name;if(A==="definitions")o=new _e(c,_);else if(A==="schema")o=new le(c,_);else throw new Error("Unexpected root element of WSDL or include");i.push(o)}}),t.onEndElementNS(function(c,l){c=l?l+":"+c:c,i[i.length-1].endElement(i,c)}),s.parseString(e),o}async processIncludes(){const e=this.definitions.schemas;let t=[];for(const s in e){const i=e[s];t=t.concat(i.includes||[])}await this.processNextInclude(t)}async processNextInclude(e){const t=e.shift();if(!t)return;let s;try{s=new URL(this.uri,window.location.href)}catch{s=new URL(this.uri)}const i=(s==null?void 0:s.href)||"http://127.0.0.1:8081",o=new URL(t.location,i),c=await de(o),l=this.definitions.schemas;l[t.namespace||c.definitions.$targetNamespace]=c.definitions,await this.processNextInclude(e)}xmlnsMap(){const e=this.definitions.xmlns;let t="";for(const s in e){if(s==="")continue;const i=e[s],o=new URL(i),c=["www.w3.org","schemas.xmlsoap.org","xml.apache.org","schemas.microsoft.com"];switch(i){case"http://xml.apache.org/xml-soap":case"http://schemas.xmlsoap.org/wsdl/":case"http://schemas.xmlsoap.org/wsdl/soap/":case"http://schemas.xmlsoap.org/soap/encoding/":case"http://www.w3.org/2001/XMLSchema":continue}c.includes(o.host)||(t+=` xmlns:${s}="${i}"`)}return t}async ready(){await this.readyPromise}objectToXML(e,t,s,i){const o=[],c="",l=s?s+":":"";if(Array.isArray(e))for(let u=0,m;m=e[u];u++)u>0&&(o.push(["</",l,t,">"].join("")),o.push(["<",l,t,c,">"].join(""))),o.push(this.objectToXML(m,t));else if(typeof e=="object")for(const u in e){const m=e[u];m===null?o.push(["<",l,u,c,"/>"].join("")):(o.push(["<",l,u,c,">"].join("")),o.push(this.objectToXML(m,u,s)),o.push(["</",l,u,">"].join("")))}else e&&o.push(Ie(e));return o.join("")}complexObjectToXML(e,t){const s=[];let i="";if(typeof e!="object")throw new Error("Wrong type of object");{const o=e.__attrs;delete e.__attrs;for(const c in o){if(typeof o[c]!="string")throw new Error(`Wrong type of attribute ${c} in element with name ${t??"not specified"}. Attributes should be strings.`);i=i.concat(` ${c}="${o[c]}"`)}if(Object.keys(e).length===0)return t?`<${t}${i}/>`:"";for(const c in e){const l=e[c];typeof l=="object"&&s.push(this.complexObjectToXML(l,c))}}return s.join("")}describeServices(){const e={};for(const t in this.services){const s=this.services[t];e[t]=s.description(this.definitions)}return e}objectToDocumentXML(e,t,s,i){const o={};return o[e]=t,this.objectToXML(o,null,s,i)}xmlToObject(e){let t;const s=new se.SaxParser(d=>{t=d});let i=null;const o={},l=[{name:null,object:o,schema:{Envelope:{Header:{Security:{UsernameToken:{Username:"string",Password:"string"}}},Body:{Fault:{faultcode:"string",faultstring:"string",detail:"string"}}}}}],u={};let m;t.onStartElementNS((d,_,R,A,S)=>{d=R?R+":"+d:d,_=_.reduce((L,M)=>(L[M[0]]=M[1],L),{}),S.forEach(L=>{const M=L[0],B=L[1];_[`xmlns${M?":":""}${M}`]=B});let p=$(d).name;const D=l[l.length-1];let x=D.schema;const Y={},H=p;if(!i&&D.name==="Body"&&p!=="Fault"){const L=this.definitions.messages;let M=L[p];if(!M){let B=!1;/Response$/.test(p)?p=p.replace(/Response$/,""):/Request$/.test(p)?(B=!0,p=p.replace(/Request$/,"")):/Solicit$/.test(p)&&(B=!0,p=p.replace(/Solicit$/,""));const j=this.definitions.portTypes,k=Object.keys(j),I=j[k[0]];B?p=I.methods[p].input.$name:p=I.methods[p].output.$name,M=L[p],L[H]=L[p]}x=M.description(this.definitions),i=H}_.href&&(m=_.href.substr(1),u[m]||(u[m]={hrefs:[],obj:null}),u[m].hrefs.push({par:D.object,key:p})),(m=_.id)&&(u[m]||(u[m]={hrefs:[],obj:null})),x&&x[p+"[]"]&&(p=p+"[]"),l.push({name:H,object:Y,schema:x==null?void 0:x[p],id:_.id,__attrs:_})}),t.onEndElementNS(function(d,_){d=_?_+":"+d:d;const R=l.pop(),A=R.object;typeof A=="object"&&(A.__attrs=R.__attrs);const S=l[l.length-1],p=S.object,D=S.schema,x=$(d).name;D&&D[x+"[]"]&&typeof D[x+"[]"]!="string"?(p[x]||(p[x]=[]),p[x].push(A)):x in p?(Array.isArray(p[x])||(p[x]=[p[x]]),p[x].push(A)):p[x]=A,R.id&&(u[R.id].obj=A)}),t.onCharacters(function(d){if(!De(d).length)return;const _=l[l.length-1],R=$(_.schema).name;let A;R==="int"?A=parseInt(d,10):R==="dateTime"?A=new Date(d):typeof _.object!="string"?A=d:A=_.object+d,_.object=A}),s.parseString(e);for(const d in u){const _=u[d],R=_.obj;_.hrefs.forEach(function(A){A.par[A.key]=R})}return o.Envelope}}async function de(n,e){const s=await(await ne(n,null)).text(),i=new $e(s,n,e);return await i.ready(),i}const ve={};async function He(n,e={}){const t=ve[n];return t||await de(n,e)}async function Be(n,e={}){const t=await He(n,e);return new xe(t,e.endpoint)}function ke(...n){return Be(n[0],n[1])}class Fe{constructor(e,t){y(this,"url");y(this,"sessionId","");y(this,"SOAPClient",null);this.url=t,this.SOAPClient=e}rowToArray(e){return Array.isArray(e)?e:e?[e]:[]}async startSession(){var s,i,o,c;const e=await((s=this.SOAPClient)==null?void 0:s.ExecuteAsync({Headers:{BeginSession:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis"}},Version:{}},Command:{Statement:""},Properties:{PropertieList:{LocaleIdentifier:"1033"}}})),t=(c=(o=(i=e==null?void 0:e.Header)==null?void 0:i.Session)==null?void 0:o.__attrs)==null?void 0:c.SessionId;this.sessionId=t}async getCatalogs(){var s;const e=await((s=this.SOAPClient)==null?void 0:s.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"DBSCHEMA_CATALOGS",Restrictions:{RestrictionList:{}},Properties:{PropertyList:{}}}));return{catalogs:this.rowToArray(e.Body.DiscoverResponse.return[0].root.row)}}async getCubes(e){var i;const t=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_CUBES",Restrictions:{RestrictionList:{CATALOG_NAME:e}},Properties:{PropertyList:{}}}));return{cubes:this.rowToArray(t.Body.DiscoverResponse.return[0].root.row)}}async getDimensions(e,t){var i;const s=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_DIMENSIONS",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)}async getHierarchies(e,t){var i;const s=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_HIERARCHIES",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)}async getLevels(e,t){var i;const s=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_LEVELS",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)}async getHierarchyLevels(e,t,s){var o;const i=await((o=this.SOAPClient)==null?void 0:o.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_LEVELS",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t,HIERARCHY_UNIQUE_NAME:s}},Properties:{PropertyList:{}}}));return this.rowToArray(i.Body.DiscoverResponse.return[0].root.row)}async getMeasureGroups(e,t){var i;const s=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_MEASUREGROUPS",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)}async getMeasures(e,t){var i;const s=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_MEASURES",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)}async getSets(e,t){var i;const s=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_SETS",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)}async getProperties(e,t){var i;const s=await((i=this.SOAPClient)==null?void 0:i.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_PROPERTIES",Restrictions:{RestrictionList:{CATALOG_NAME:e,CUBE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)}async getMembers(e){var s;const t=await((s=this.SOAPClient)==null?void 0:s.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_MEMBERS",Restrictions:{RestrictionList:{CATALOG_NAME:e.CATALOG_NAME,CUBE_NAME:e.CUBE_NAME,DIMENSION_UNIQUE_NAME:e.DIMENSION_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME:e.HIERARCHY_UNIQUE_NAME,LEVEL_UNIQUE_NAME:e.LEVEL_UNIQUE_NAME}},Properties:{PropertyList:{}}}));return this.rowToArray(t.Body.DiscoverResponse.return[0].root.row)}async getLevelMembers(e,t,s){const i=`
      select Subset(${e.LEVEL_UNIQUE_NAME}.AllMembers, ${s}, ${t+1}) 
      DIMENSION PROPERTIES MEMBER_TYPE on 0, 
      {} on 1 
      from ${e.CUBE_NAME}
    `,o=await this.getMDX(i);return this.rowToArray(o.Body.ExecuteResponse.return.root.Axes.Axis[0].Tuples.Tuple)}async getChildMembers(e,t,s){const i=`
      select Subset({AddCalculatedMembers(${e.MEMBER_UNIQUE_NAME}.Children)}, ${s}, ${t+1}) 
      DIMENSION PROPERTIES MEMBER_TYPE on 0, 
      {} on 1 
      from ${e.CUBE_NAME}
    `,o=await this.getMDX(i);return this.rowToArray(o.Body.ExecuteResponse.return.root.Axes.Axis[0].Tuples.Tuple)}async getMDX(e){var s;return await((s=this.SOAPClient)==null?void 0:s.ExecuteAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},Command:{Statement:e},Properties:{}}))}async getPivotTableData(e,t,s,i,o){var _,R,A,S,p,D,x,Y,H;let c;if(t.length&&s.length){const L=[];let M="";t.length>=1?t.forEach((O,F)=>{F===0?M=`Hierarchize({DrilldownLevel({${O.originalItem.HIERARCHY_UNIQUE_NAME}},,,INCLUDE_CALC_MEMBERS)})`:M=`
              CrossJoin(
                ${M},
                Hierarchize({DrilldownLevel({${O.originalItem.HIERARCHY_UNIQUE_NAME}},,,INCLUDE_CALC_MEMBERS)})
              )
            `}):M=`{ ${t[0].originalItem.HIERARCHY_UNIQUE_NAME}.Members }`,t.forEach(O=>{L.push(o.filter(F=>F.HIERARCHY_UNIQUE_NAME===O.originalItem.HIERARCHY_UNIQUE_NAME))});const B=[];let j="";s.length>=1?s.forEach((O,F)=>{F===0?j=`Hierarchize({DrilldownLevel({${O.originalItem.HIERARCHY_UNIQUE_NAME}},,,INCLUDE_CALC_MEMBERS)})`:j=`
              CrossJoin(
                ${j},
                Hierarchize({DrilldownLevel({${O.originalItem.HIERARCHY_UNIQUE_NAME}},,,INCLUDE_CALC_MEMBERS)})
              )
            `}):j=`{ ${s[0].originalItem.HIERARCHY_UNIQUE_NAME}.Members }`,s.forEach(O=>{B.push(o.filter(F=>F.HIERARCHY_UNIQUE_NAME===O.originalItem.HIERARCHY_UNIQUE_NAME))});let k=B.flat(1).map(O=>`${O.LEVEL_UNIQUE_NAME}.[${O.PROPERTY_NAME}]`).join(","),I=L.flat(1).map(O=>`${O.LEVEL_UNIQUE_NAME}.[${O.PROPERTY_NAME}]`).join(",");k&&(k=`,${k}`),I&&(I=`,${I}`),i.showEmpty?c=`
            SELECT
            ${j} DIMENSION PROPERTIES PARENT_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME${k} ON 1,
            ${M} DIMENSION PROPERTIES PARENT_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME${I}  ON 0
            FROM ${e}
        `:c=`
            SELECT
            NON EMPTY ${j} DIMENSION PROPERTIES PARENT_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME${k} ON 1,
            NON EMPTY ${M} DIMENSION PROPERTIES PARENT_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME${I} ON 0
            FROM ${e}
        `,console.log(c)}else c=`
          SELECT
          FROM ${e}
      `;const l=await this.getMDX(c),u=this.rowToArray((S=(A=(R=(_=l.Body.ExecuteResponse.return.root.Axes)==null?void 0:_.Axis)==null?void 0:R[0])==null?void 0:A.Tuples)==null?void 0:S.Tuple),m=this.rowToArray((Y=(x=(D=(p=l.Body.ExecuteResponse.return.root.Axes)==null?void 0:p.Axis)==null?void 0:D[1])==null?void 0:x.Tuples)==null?void 0:Y.Tuple),d=this.rowToArray((H=l.Body.ExecuteResponse.return.root.CellData)==null?void 0:H.Cell);return{axis0:u,axis1:m,cells:d}}async getMember(e,t){var o;const s=await((o=this.SOAPClient)==null?void 0:o.DiscoverAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},RequestType:"MDSCHEMA_MEMBERS",Restrictions:{RestrictionList:{CATALOG_NAME:e.CATALOG_NAME,CUBE_NAME:e.CUBE_NAME,DIMENSION_UNIQUE_NAME:e.DIMENSION_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME:e.HIERARCHY_UNIQUE_NAME,LEVEL_UNIQUE_NAME:e.LEVEL_UNIQUE_NAME,MEMBER_UNIQUE_NAME:t}},Properties:{PropertyList:{}}}));return this.rowToArray(s.Body.DiscoverResponse.return[0].root.row)[0]}async getDrillthroughMDX(e){var s;return await((s=this.SOAPClient)==null?void 0:s.ExecuteAsync({Headers:{Session:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},Command:{Statement:e},Properties:{PropertyList:{Format:"Tabular"}}}))}async endSession(){var e;await((e=this.SOAPClient)==null?void 0:e.ExecuteAsync({Headers:{EndSession:{__attrs:{xmlns:"urn:schemas-microsoft-com:xml-analysis",SessionId:this.sessionId}}},Command:{Statement:{}},Properties:{}})),this.sessionId=""}}export{Fe as X,ke as c};
